<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="/css/style.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/header.css">
    <link rel="stylesheet" href="/css/footer.css">

    {{!-- Noty notifications --}}
<script src="https://cdnjs.cloudflare.com/ajax/libs/noty/3.1.4/noty.min.js" integrity="sha512-lOrm9FgT1LKOJRUXF3tp6QaMorJftUjowOWiDcG5GFZ/q7ukof19V0HKx/GWzXCdt9zYju3/KhBNdCLzK8b90Q==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/noty/3.1.4/noty.min.css" integrity="sha512-0p3K0H3S6Q4bEWZ/WmC94Tgit2ular2/n0ESdfEX8l172YyQj8re1Wu9s/HT9T/T2osUw5Gx/6pAZNk3UKbESw==" crossorigin="anonymous" referrerpolicy="no-referrer" />


    {{!-- jquery cdn --}}
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

</head>
<body>

    {{>header}}

        <div class="post_container">

            <div class="posts">
        {{#if ouser }}
        <section id="feed-posts" style="display: inline-block;">
            <form action="/post/create" id="new-post-form" method="post">
            Posts<br><br>
                <textarea name="content" id="content" placeholder="Type Here ...." rows="3" cols="30" required></textarea>
                <br><br>
                <input type="submit" value="Submit">
            </form>
        </section>
        {{/if}}

        <br>

        <p>Posts of the users</p>

        {{!-- <br> --}}
        <ul>
            {{#each posts}}

            {{!-- {{>posts}} --}}
        <li class="post-{{this._id}}" >
            <div class="post" >
            {{!-- {{@root.user.path.to.ouser}} --}}

                {{#if ../ouser }}
                    {{#compare ../ouser "==" this.user.id }}
                    <small><a id="delete-post-button" href="/post/destroy/{{this._id}}"> X </a></small>
                    {{/compare}}
                {{/if}}

                {{this.content}}
                <br>
                {{this.user.name}} creted the post! 

                {{!-- Printing all the comments --}}
                <br>
                <p>Comments</p>
                <div id="post-comments-{{this._id}}">
                {{#each this.comments}}
                    {{!-- {{>comments}} --}}
                    <div id=comment-id-{{this.comment._id}}>
                        {{#if ../../ouser }}
                            {{#compare ../../ouser "==" this.comment.user.id }}
                                <small><a id="delete-comment-button" href="/comment/destroy/{{this.comment._id}}"> X </a></small>
                            {{/compare}}
                        {{/if}}

                        {{this.comment.content}}
                        <br>
                        {{this.comment.user.name}}
                        <br><br>
                    </div>
                {{/each}}
                </div>
                {{!-- <br> --}}
                {{!-- {{/if}} --}}
                {{!-- <br> --}}

                {{#if ../ouser }}
                {{!-- {{user.name}} --}}
                {{!-- <br> --}}
                <section>
                    <form id="comment-form" action="/comment/create" method="post">
                        <input type="hidden" name="post_id" value={{this._id}} >
                        <textarea name="comment" cols="30" rows="3" placeholder="Write Comment...." required></textarea>
                        <input type="submit" value="Submit Comment!!">
                    </form>
                </section>
                {{/if}}
                
            </div>
            <br>
            </li>


            {{/each}}
        </ul>
    </div>


    <div class="friends">
    {{>friends}}
    </div>
</div>
<br>

<script>

    {{#if flash.success }}
        {{#compare flash.success.length ">" 0 }}
            new Noty({
                type:'success',
                text: '{{flash.success}}',
                layout:'topRight',
                theme: 'relax',
                timeout: 1500,
                progressBar:true
            }).show();
        {{/compare}}
    {{/if}}

    {{#if flash.error }}
            {{#compare flash.error.length ">" 0 }}
                new Noty({
                    type:'error',
                    text: '{{flash.error}}',
                    layout:'topRight',
                    theme: 'relax',
                    timeout: 1500,
                    progressBar:true
                }).show();
            {{/compare}}
        {{/if}}

        

</script>

<script src="/js/posts_app_page.js"></script>
    
</body>
</html>




